import { ItemView, setIcon } from "obsidian";
import { basename } from "path";
export const EXECUTOR_MANAGER_VIEW_ID = "code-execute-manage-executors";
export const EXECUTOR_MANAGER_OPEN_VIEW_COMMAND_ID = "code-execute-open-manage-executors";
export default class ExecutorManagerView extends ItemView {
    constructor(leaf, executors) {
        super(leaf);
        this.executors = executors;
        this.executors.on("add", (executor) => {
            this.addExecutorElement(executor);
        });
    }
    /**
     * Open the view. Ensure that there may only be one view at a time.
     * If there isn't one created, then create a new one.
     * @param workspace the workspace of the Obsidian app
     */
    static async activate(workspace) {
        workspace.detachLeavesOfType(EXECUTOR_MANAGER_VIEW_ID);
        await workspace.getRightLeaf(false).setViewState({
            type: EXECUTOR_MANAGER_VIEW_ID,
            active: true,
        });
        workspace.revealLeaf(workspace.getLeavesOfType(EXECUTOR_MANAGER_VIEW_ID)[0]);
    }
    getViewType() {
        return EXECUTOR_MANAGER_VIEW_ID;
    }
    getDisplayText() {
        return "Execution Runtimes";
    }
    getIcon() {
        return "command-glyph";
    }
    /**
     * Set up the HTML of the view
     */
    async onOpen() {
        const container = this.contentEl;
        container.empty();
        container.classList.add("manage-executors-view");
        const header = document.createElement("h3");
        header.textContent = "Runtimes";
        container.appendChild(header);
        this.list = document.createElement("ul");
        container.appendChild(document.createElement("div")).appendChild(this.list);
        for (const executor of this.executors) {
            this.addExecutorElement(executor);
        }
        this.addEmptyState();
    }
    async onClose() {
    }
    /**
     * Add the empty state element to the view. Also update the empty state element
     */
    addEmptyState() {
        this.emptyStateElement = document.createElement("div");
        this.emptyStateElement.classList.add("empty-state");
        this.emptyStateElement.textContent = "There are currently no runtimes online. Run some code blocks, and their runtimes will appear here.";
        this.list.parentElement.appendChild(this.emptyStateElement);
        this.updateEmptyState();
    }
    /**
     * If the list of runtimes is empty, then show the empty-state; otherwise, hide it.
     */
    updateEmptyState() {
        if (this.list.childElementCount == 0) {
            this.emptyStateElement.style.display = "block";
        }
        else {
            this.emptyStateElement.style.display = "none";
        }
    }
    /**
     * Creates and adds a manager widget list-item for a given executor.
     *
     * @param executor an executor to create a manager widget for
     */
    addExecutorElement(executor) {
        const li = document.createElement("li");
        const simpleName = basename(executor.file);
        const langElem = document.createElement("small");
        langElem.textContent = executor.language;
        li.appendChild(langElem);
        li.appendChild(this.createFilenameRowElem(simpleName));
        executor.on("close", () => {
            li.remove();
            this.updateEmptyState();
        });
        const button = document.createElement("button");
        button.addEventListener("click", () => executor.stop());
        setIcon(button, "trash");
        button.setAttribute("aria-label", "Stop Runtime");
        li.appendChild(button);
        this.list.appendChild(li);
        this.updateEmptyState();
    }
    /**
     * A helper method to create a file-name label for use in
     * runtime management widgets
     * @param text text content for the filename label
     * @returns the filename label's html element
     */
    createFilenameRowElem(text) {
        const fElem = document.createElement("span");
        fElem.textContent = text;
        fElem.classList.add("filename");
        return fElem;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXhlY3V0b3JNYW5hZ2VyVmlldy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkV4ZWN1dG9yTWFuYWdlclZpZXcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLFFBQVEsRUFBRSxPQUFPLEVBQTJCLE1BQU0sVUFBVSxDQUFDO0FBQ3JFLE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFJOUIsTUFBTSxDQUFDLE1BQU0sd0JBQXdCLEdBQUcsK0JBQStCLENBQUM7QUFDeEUsTUFBTSxDQUFDLE1BQU0scUNBQXFDLEdBQUcsb0NBQW9DLENBQUM7QUFFMUYsTUFBTSxDQUFDLE9BQU8sT0FBTyxtQkFBb0IsU0FBUSxRQUFRO0lBTXhELFlBQVksSUFBbUIsRUFBRSxTQUE0QjtRQUM1RCxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFWixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUUzQixJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxRQUFRLEVBQUUsRUFBRTtZQUNyQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7SUFDSixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFNBQW9CO1FBQ3pDLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1FBRXZELE1BQU0sU0FBUyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxZQUFZLENBQUM7WUFDaEQsSUFBSSxFQUFFLHdCQUF3QjtZQUM5QixNQUFNLEVBQUUsSUFBSTtTQUNaLENBQUMsQ0FBQztRQUVILFNBQVMsQ0FBQyxVQUFVLENBQ25CLFNBQVMsQ0FBQyxlQUFlLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDdEQsQ0FBQztJQUNILENBQUM7SUFFRCxXQUFXO1FB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QyxDQUFDO1FBQ2hELE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFDeEQsT0FBTyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN6QixNQUFNLENBQUMsWUFBWSxDQUFDLFlBQVksRUFBRSxjQUFjLENBQUMsQ0FBQztRQUNsRCxFQUFFLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRXZCLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzFCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQ3pCLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNLLHFCQUFxQixDQUFDLElBQVk7UUFDekMsTUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUM3QyxLQUFLLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztRQUN6QixLQUFLLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoQyxPQUFPLEtBQUssQ0FBQztJQUNkLENBQUM7Q0FDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SXRlbVZpZXcsIHNldEljb24sIFdvcmtzcGFjZSwgV29ya3NwYWNlTGVhZn0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7YmFzZW5hbWV9IGZyb20gXCJwYXRoXCI7XHJcbmltcG9ydCBFeGVjdXRvckNvbnRhaW5lciBmcm9tIFwiLi9FeGVjdXRvckNvbnRhaW5lclwiO1xyXG5pbXBvcnQgRXhlY3V0b3IgZnJvbSBcIi4vZXhlY3V0b3JzL0V4ZWN1dG9yXCI7XHJcblxyXG5leHBvcnQgY29uc3QgRVhFQ1VUT1JfTUFOQUdFUl9WSUVXX0lEID0gXCJjb2RlLWV4ZWN1dGUtbWFuYWdlLWV4ZWN1dG9yc1wiO1xyXG5leHBvcnQgY29uc3QgRVhFQ1VUT1JfTUFOQUdFUl9PUEVOX1ZJRVdfQ09NTUFORF9JRCA9IFwiY29kZS1leGVjdXRlLW9wZW4tbWFuYWdlLWV4ZWN1dG9yc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXhlY3V0b3JNYW5hZ2VyVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcclxuXHRleGVjdXRvcnM6IEV4ZWN1dG9yQ29udGFpbmVyO1xyXG5cclxuXHRsaXN0OiBIVE1MVUxpc3RFbGVtZW50XHJcblx0ZW1wdHlTdGF0ZUVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50O1xyXG5cclxuXHRjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBleGVjdXRvcnM6IEV4ZWN1dG9yQ29udGFpbmVyKSB7XHJcblx0XHRzdXBlcihsZWFmKTtcclxuXHJcblx0XHR0aGlzLmV4ZWN1dG9ycyA9IGV4ZWN1dG9ycztcclxuXHJcblx0XHR0aGlzLmV4ZWN1dG9ycy5vbihcImFkZFwiLCAoZXhlY3V0b3IpID0+IHtcclxuXHRcdFx0dGhpcy5hZGRFeGVjdXRvckVsZW1lbnQoZXhlY3V0b3IpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBPcGVuIHRoZSB2aWV3LiBFbnN1cmUgdGhhdCB0aGVyZSBtYXkgb25seSBiZSBvbmUgdmlldyBhdCBhIHRpbWUuXHJcblx0ICogSWYgdGhlcmUgaXNuJ3Qgb25lIGNyZWF0ZWQsIHRoZW4gY3JlYXRlIGEgbmV3IG9uZS5cclxuXHQgKiBAcGFyYW0gd29ya3NwYWNlIHRoZSB3b3Jrc3BhY2Ugb2YgdGhlIE9ic2lkaWFuIGFwcFxyXG5cdCAqL1xyXG5cdHN0YXRpYyBhc3luYyBhY3RpdmF0ZSh3b3Jrc3BhY2U6IFdvcmtzcGFjZSkge1xyXG5cdFx0d29ya3NwYWNlLmRldGFjaExlYXZlc09mVHlwZShFWEVDVVRPUl9NQU5BR0VSX1ZJRVdfSUQpO1xyXG5cclxuXHRcdGF3YWl0IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpLnNldFZpZXdTdGF0ZSh7XHJcblx0XHRcdHR5cGU6IEVYRUNVVE9SX01BTkFHRVJfVklFV19JRCxcclxuXHRcdFx0YWN0aXZlOiB0cnVlLFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYoXHJcblx0XHRcdHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoRVhFQ1VUT1JfTUFOQUdFUl9WSUVXX0lEKVswXVxyXG5cdFx0KTtcclxuXHR9XHJcblxyXG5cdGdldFZpZXdUeXBlKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gRVhFQ1VUT1JfTUFOQUdFUl9WSUVXX0lEO1xyXG5cdH1cclxuXHJcblx0Z2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBcIkV4ZWN1dGlvbiBSdW50aW1lc1wiO1xyXG5cdH1cclxuXHJcblx0Z2V0SWNvbigpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIFwiY29tbWFuZC1nbHlwaFwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogU2V0IHVwIHRoZSBIVE1MIG9mIHRoZSB2aWV3XHJcblx0ICovXHJcblx0YXN5bmMgb25PcGVuKCkge1xyXG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWw7XHJcblx0XHRjb250YWluZXIuZW1wdHkoKTtcclxuXHJcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm1hbmFnZS1leGVjdXRvcnMtdmlld1wiKTtcclxuXHJcblx0XHRjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDNcIik7XHJcblx0XHRoZWFkZXIudGV4dENvbnRlbnQgPSBcIlJ1bnRpbWVzXCI7XHJcblx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcclxuXHJcblx0XHR0aGlzLmxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidWxcIik7XHJcblx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSkuYXBwZW5kQ2hpbGQodGhpcy5saXN0KTtcclxuXHJcblx0XHRmb3IgKGNvbnN0IGV4ZWN1dG9yIG9mIHRoaXMuZXhlY3V0b3JzKSB7XHJcblx0XHRcdHRoaXMuYWRkRXhlY3V0b3JFbGVtZW50KGV4ZWN1dG9yKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmFkZEVtcHR5U3RhdGUoKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIG9uQ2xvc2UoKSB7XHJcblxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQWRkIHRoZSBlbXB0eSBzdGF0ZSBlbGVtZW50IHRvIHRoZSB2aWV3LiBBbHNvIHVwZGF0ZSB0aGUgZW1wdHkgc3RhdGUgZWxlbWVudFxyXG5cdCAqL1xyXG5cdHByaXZhdGUgYWRkRW1wdHlTdGF0ZSgpIHtcclxuXHRcdHRoaXMuZW1wdHlTdGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG5cdFx0dGhpcy5lbXB0eVN0YXRlRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZW1wdHktc3RhdGVcIik7XHJcblx0XHR0aGlzLmVtcHR5U3RhdGVFbGVtZW50LnRleHRDb250ZW50ID0gXCJUaGVyZSBhcmUgY3VycmVudGx5IG5vIHJ1bnRpbWVzIG9ubGluZS4gUnVuIHNvbWUgY29kZSBibG9ja3MsIGFuZCB0aGVpciBydW50aW1lcyB3aWxsIGFwcGVhciBoZXJlLlwiO1xyXG5cclxuXHRcdHRoaXMubGlzdC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuZW1wdHlTdGF0ZUVsZW1lbnQpO1xyXG5cclxuXHRcdHRoaXMudXBkYXRlRW1wdHlTdGF0ZSgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogSWYgdGhlIGxpc3Qgb2YgcnVudGltZXMgaXMgZW1wdHksIHRoZW4gc2hvdyB0aGUgZW1wdHktc3RhdGU7IG90aGVyd2lzZSwgaGlkZSBpdC5cclxuXHQgKi9cclxuXHRwcml2YXRlIHVwZGF0ZUVtcHR5U3RhdGUoKSB7XHJcblx0XHRpZiAodGhpcy5saXN0LmNoaWxkRWxlbWVudENvdW50ID09IDApIHtcclxuXHRcdFx0dGhpcy5lbXB0eVN0YXRlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5lbXB0eVN0YXRlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDcmVhdGVzIGFuZCBhZGRzIGEgbWFuYWdlciB3aWRnZXQgbGlzdC1pdGVtIGZvciBhIGdpdmVuIGV4ZWN1dG9yLlxyXG5cdCAqXHJcblx0ICogQHBhcmFtIGV4ZWN1dG9yIGFuIGV4ZWN1dG9yIHRvIGNyZWF0ZSBhIG1hbmFnZXIgd2lkZ2V0IGZvclxyXG5cdCAqL1xyXG5cdHByaXZhdGUgYWRkRXhlY3V0b3JFbGVtZW50KGV4ZWN1dG9yOiBFeGVjdXRvcikge1xyXG5cdFx0Y29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XHJcblxyXG5cdFx0Y29uc3Qgc2ltcGxlTmFtZSA9IGJhc2VuYW1lKGV4ZWN1dG9yLmZpbGUpO1xyXG5cclxuXHRcdGNvbnN0IGxhbmdFbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNtYWxsXCIpO1xyXG5cdFx0bGFuZ0VsZW0udGV4dENvbnRlbnQgPSBleGVjdXRvci5sYW5ndWFnZTtcclxuXHRcdGxpLmFwcGVuZENoaWxkKGxhbmdFbGVtKTtcclxuXHJcblx0XHRsaS5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUZpbGVuYW1lUm93RWxlbShzaW1wbGVOYW1lKSk7XHJcblxyXG5cdFx0ZXhlY3V0b3Iub24oXCJjbG9zZVwiLCAoKSA9PiB7XHJcblx0XHRcdGxpLnJlbW92ZSgpO1xyXG5cdFx0XHR0aGlzLnVwZGF0ZUVtcHR5U3RhdGUoKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcblx0XHRidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGV4ZWN1dG9yLnN0b3AoKSk7XHJcblx0XHRzZXRJY29uKGJ1dHRvbiwgXCJ0cmFzaFwiKTtcclxuXHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIFwiU3RvcCBSdW50aW1lXCIpO1xyXG5cdFx0bGkuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcclxuXHJcblx0XHR0aGlzLmxpc3QuYXBwZW5kQ2hpbGQobGkpO1xyXG5cdFx0dGhpcy51cGRhdGVFbXB0eVN0YXRlKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBBIGhlbHBlciBtZXRob2QgdG8gY3JlYXRlIGEgZmlsZS1uYW1lIGxhYmVsIGZvciB1c2UgaW5cclxuXHQgKiBydW50aW1lIG1hbmFnZW1lbnQgd2lkZ2V0c1xyXG5cdCAqIEBwYXJhbSB0ZXh0IHRleHQgY29udGVudCBmb3IgdGhlIGZpbGVuYW1lIGxhYmVsXHJcblx0ICogQHJldHVybnMgdGhlIGZpbGVuYW1lIGxhYmVsJ3MgaHRtbCBlbGVtZW50XHJcblx0ICovXHJcblx0cHJpdmF0ZSBjcmVhdGVGaWxlbmFtZVJvd0VsZW0odGV4dDogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBmRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG5cdFx0ZkVsZW0udGV4dENvbnRlbnQgPSB0ZXh0O1xyXG5cdFx0ZkVsZW0uY2xhc3NMaXN0LmFkZChcImZpbGVuYW1lXCIpO1xyXG5cdFx0cmV0dXJuIGZFbGVtO1xyXG5cdH1cclxufVxyXG4iXX0=